(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{6348:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add-sub-account",function(){return t(1140)}])},1140:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return q}});var a=t(2322),r=t(7190),i=t(7993),s=t(8678),p=t(7166),d=t(5297),y=t(3297),u=t(9669),l=t(2405),o=t(2784),m=t(9310),c=t(2787),T=t(1844),b=t(7852),g=t(4792),w=t(8535),S=t(8409);function f(e){let{sdk:n}=e,[t,r]=(0,o.useState)(),i=(0,o.useCallback)(async()=>{if(n)try{let e=await (0,l.eK)(),t=await n.subAccount.addOwner({chainId:S.L.id,publicKey:e.account.publicKey});console.info("response",t),r(t)}catch(e){console.error("error",e)}},[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:i,children:"Add Owner"}),t&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",children:JSON.stringify(t,null,2)})]})}var h=t(6940);function x(e){let{sdk:n,onAddSubAccount:t,signerFn:r}=e,[i,s]=(0,o.useState)(),p=(0,o.useCallback)(async()=>{if(!n)return;let{account:e}=await r();if(!e)throw Error("Could not get owner account");let a=n.getProvider();await a.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,h.eC)(84532)}]});let i=await a.request({method:"wallet_addSubAccount",params:[{version:"1",account:{type:"create",keys:"webAuthn"===e.type?[{type:"webauthn-p256",publicKey:e.publicKey}]:[{type:"address",publicKey:e.address}]}}]});console.info("response",i),s(i.address),t(i.address)},[n,t,r]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:p,children:"Add Address"}),i&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",children:JSON.stringify(i,null,2)})]})}function P(e){let{sdk:n,onAddSubAccount:t,signerFn:r}=e,[i,s]=(0,o.useState)(),p=(0,o.useCallback)(async()=>{if(!n)return;let{account:e}=await r();if(!e)throw Error("Could not get owner account");let a=n.getProvider();await a.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,h.eC)(84532)}]});let i=await a.request({method:"wallet_addSubAccount",params:[{version:"1",account:{type:"create"}}]});console.info("response",i),s(i.address),t(i.address)},[n,t,r]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:p,children:"Add Address (Without Keys)"}),i&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",children:JSON.stringify(i,null,2)})]})}function v(e){let{sdk:n}=e,[t,r]=(0,o.useState)(),i=(0,o.useCallback)(async()=>{if(!n)return;let e=n.getProvider(),t=await e.request({method:"eth_requestAccounts"});console.info("response",t),r(t)},[n]);return(0,o.useEffect)(()=>{n&&n.getProvider().on("accountsChanged",e=>{0===e.length?r(void 0):r(e)})},[n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:i,children:"Connect"}),t&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",children:JSON.stringify(t,null,2)})]})}function k(){let[e,n]=(0,o.useState)(),t=(0,o.useCallback)(async()=>{try{await (0,l.rb)();let{account:e}=await (0,l.eK)();n(e.publicKey)}catch(e){console.error("error",e)}},[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:t,children:"Generate New Signer"}),e&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(e,null,2)})]})}function C(e){let{sdk:n}=e,[t,r]=(0,o.useState)(),[i,s]=(0,o.useState)(),[p,d]=(0,o.useState)(!1),y=(0,o.useCallback)(async()=>{if(n){d(!0);try{let e=n.getProvider(),t=await e.request({method:"eth_requestAccounts"});if(t.length<2)throw Error("Create a sub account first by clicking the Add Address button");let a=await e.request({method:"wallet_getSubAccounts",params:[{account:t[1],domain:window.location.origin}]});console.info("getSubAccounts response",a),r(a)}catch(e){console.error("Error getting sub accounts:",e),s(e instanceof Error?e.message:"Unknown error")}finally{d(!1)}}},[n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:y,isLoading:p,loadingText:"Getting Sub Accounts...",children:"Get Sub Accounts"}),t&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(t,null,2)}),i&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"red.900",borderRadius:"md",border:"1px solid",borderColor:"red.700",overflow:"auto",whiteSpace:"pre-wrap",children:i})]})}let M="0xf85210B21cC50302F477BA56686d2019dC9b67Ad",A=e=>{let{chainId:n,account:t,spender:a,token:r,allowance:i,period:s,start:p,end:d,salt:y,extraData:u}=e;return{domain:{name:"Spend Permission Manager",version:"1",chainId:n,verifyingContract:M},types:{SpendPermission:[{name:"account",type:"address"},{name:"spender",type:"address"},{name:"token",type:"address"},{name:"allowance",type:"uint160"},{name:"period",type:"uint48"},{name:"start",type:"uint48"},{name:"end",type:"uint48"},{name:"salt",type:"uint256"},{name:"extraData",type:"bytes"}]},primaryType:"SpendPermission",message:{account:t,spender:a,token:r,allowance:i,period:s,start:p,end:d,salt:y,extraData:u}}};function E(e){let{sdk:n,subAccountAddress:t}=e,[r,i]=(0,o.useState)(),s=(0,o.useCallback)(async()=>{if(n)try{let e=n.getProvider(),a=(await (null==e?void 0:e.request({method:"eth_accounts",params:[{version:"1",capabilities:{}}]})))[0],r={chainId:S.L.id,account:a,spender:t,token:"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",allowance:"0x5AF3107A4000",period:86400,start:1724264802,end:17242884802,salt:"0x1",extraData:"0x"},s=A(r),p=await (null==e?void 0:e.request({method:"eth_signTypedData_v4",params:[a,s]}));console.info("response",p),localStorage.setItem("cbwsdk.demo.spend-permission.signature",p),localStorage.setItem("cbwsdk.demo.spend-permission.data",JSON.stringify(r)),i(p)}catch(e){console.error("error",e)}},[n,t]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:s,children:"Grant Spend Permission"}),r&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(r,null,2)})]})}let j=[{type:"constructor",inputs:[{name:"publicERC6492Validator",type:"address",internalType:"contract PublicERC6492Validator"},{name:"magicSpend",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"MAGIC_SPEND",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"NATIVE_TOKEN",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"PERMISSION_DETAILS_TYPEHASH",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"PUBLIC_ERC6492_VALIDATOR",inputs:[],outputs:[{name:"",type:"address",internalType:"contract PublicERC6492Validator"}],stateMutability:"view"},{type:"function",name:"SPEND_PERMISSION_BATCH_TYPEHASH",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"SPEND_PERMISSION_TYPEHASH",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"approve",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"approveBatchWithSignature",inputs:[{name:"spendPermissionBatch",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermissionBatch",components:[{name:"account",type:"address",internalType:"address"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"permissions",type:"tuple[]",internalType:"struct SpendPermissionManager.PermissionDetails[]",components:[{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}]},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"approveWithRevoke",inputs:[{name:"permissionToApprove",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]},{name:"permissionToRevoke",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]},{name:"expectedLastUpdatedPeriod",type:"tuple",internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"approveWithSignature",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"nonpayable"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getBatchHash",inputs:[{name:"spendPermissionBatch",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermissionBatch",components:[{name:"account",type:"address",internalType:"address"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"permissions",type:"tuple[]",internalType:"struct SpendPermissionManager.PermissionDetails[]",components:[{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}]}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"getCurrentPeriod",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"tuple",internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]}],stateMutability:"view"},{type:"function",name:"getHash",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"getLastUpdatedPeriod",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"tuple",internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]}],stateMutability:"view"},{type:"function",name:"isApproved",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isRevoked",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isValid",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"revoke",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"revokeAsSpender",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"spend",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]},{name:"value",type:"uint160",internalType:"uint160"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"spendWithWithdraw",inputs:[{name:"spendPermission",type:"tuple",internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]},{name:"value",type:"uint160",internalType:"uint160"},{name:"withdrawRequest",type:"tuple",internalType:"struct MagicSpend.WithdrawRequest",components:[{name:"signature",type:"bytes",internalType:"bytes"},{name:"asset",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"expiry",type:"uint48",internalType:"uint48"}]}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"SpendPermissionApproved",inputs:[{name:"hash",type:"bytes32",indexed:!0,internalType:"bytes32"},{name:"spendPermission",type:"tuple",indexed:!1,internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],anonymous:!1},{type:"event",name:"SpendPermissionRevoked",inputs:[{name:"hash",type:"bytes32",indexed:!0,internalType:"bytes32"},{name:"spendPermission",type:"tuple",indexed:!1,internalType:"struct SpendPermissionManager.SpendPermission",components:[{name:"account",type:"address",internalType:"address"},{name:"spender",type:"address",internalType:"address"},{name:"token",type:"address",internalType:"address"},{name:"allowance",type:"uint160",internalType:"uint160"},{name:"period",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"salt",type:"uint256",internalType:"uint256"},{name:"extraData",type:"bytes",internalType:"bytes"}]}],anonymous:!1},{type:"event",name:"SpendPermissionUsed",inputs:[{name:"hash",type:"bytes32",indexed:!0,internalType:"bytes32"},{name:"account",type:"address",indexed:!0,internalType:"address"},{name:"spender",type:"address",indexed:!0,internalType:"address"},{name:"token",type:"address",indexed:!1,internalType:"address"},{name:"periodSpend",type:"tuple",indexed:!1,internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]}],anonymous:!1},{type:"error",name:"AfterSpendPermissionEnd",inputs:[{name:"currentTimestamp",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"}]},{type:"error",name:"BeforeSpendPermissionStart",inputs:[{name:"currentTimestamp",type:"uint48",internalType:"uint48"},{name:"start",type:"uint48",internalType:"uint48"}]},{type:"error",name:"ERC721TokenNotSupported",inputs:[{name:"token",type:"address",internalType:"address"}]},{type:"error",name:"EmptySpendPermissionBatch",inputs:[]},{type:"error",name:"ExceededSpendPermission",inputs:[{name:"value",type:"uint256",internalType:"uint256"},{name:"allowance",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidLastUpdatedPeriod",inputs:[{name:"actualLastUpdatedPeriod",type:"tuple",internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]},{name:"expectedLastUpdatedPeriod",type:"tuple",internalType:"struct SpendPermissionManager.PeriodSpend",components:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"},{name:"spend",type:"uint160",internalType:"uint160"}]}]},{type:"error",name:"InvalidSender",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"expected",type:"address",internalType:"address"}]},{type:"error",name:"InvalidSignature",inputs:[]},{type:"error",name:"InvalidStartEnd",inputs:[{name:"start",type:"uint48",internalType:"uint48"},{name:"end",type:"uint48",internalType:"uint48"}]},{type:"error",name:"InvalidWithdrawRequestNonce",inputs:[{name:"noncePostfix",type:"uint128",internalType:"uint128"},{name:"permissionHashPostfix",type:"uint128",internalType:"uint128"}]},{type:"error",name:"MismatchedAccounts",inputs:[{name:"firstAccount",type:"address",internalType:"address"},{name:"secondAccount",type:"address",internalType:"address"}]},{type:"error",name:"SafeERC20FailedOperation",inputs:[{name:"token",type:"address",internalType:"address"}]},{type:"error",name:"SpendTokenWithdrawAssetMismatch",inputs:[{name:"spendToken",type:"address",internalType:"address"},{name:"withdrawAsset",type:"address",internalType:"address"}]},{type:"error",name:"SpendValueOverflow",inputs:[{name:"value",type:"uint256",internalType:"uint256"}]},{type:"error",name:"SpendValueWithdrawAmountMismatch",inputs:[{name:"spendValue",type:"uint256",internalType:"uint256"},{name:"withdrawAmount",type:"uint256",internalType:"uint256"}]},{type:"error",name:"UnauthorizedSpendPermission",inputs:[]},{type:"error",name:"UnexpectedReceiveAmount",inputs:[{name:"received",type:"uint256",internalType:"uint256"},{name:"expected",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ZeroAllowance",inputs:[]},{type:"error",name:"ZeroPeriod",inputs:[]},{type:"error",name:"ZeroSpender",inputs:[]},{type:"error",name:"ZeroToken",inputs:[]},{type:"error",name:"ZeroValue",inputs:[]}];var _=t(6797),I=t(5354);function D(e){let{sdk:n,subAccountAddress:t}=e,[r,i]=(0,o.useState)(),s=(0,o.useCallback)(async()=>{if(!n)return;let e=n.getProvider();try{let n=await e.request({method:"personal_sign",params:[(0,h.NC)("Hello, world!"),t]}),a=(0,_.v)({chain:S.L,transport:(0,I.d)()}),r=await a.verifyMessage({address:t,message:"Hello, world!",signature:n});console.info("response",n),i("isValid: ".concat(r?"true":"false"," ").concat(n," "))}catch(e){console.error("error",e)}},[n,t]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:s,children:"Personal Sign"}),r&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(r,null,2)})]})}function N(e){let{sdk:n,subAccountAddress:t}=e,[r,i]=(0,o.useState)(),s=(0,o.useCallback)(async()=>{if(!n)return;let e=n.getProvider();try{let n=await e.request({method:"wallet_sendCalls",params:[{chainId:(0,h.eC)(S.L.id),from:t,calls:[{to:"0x000000000000000000000000000000000000dead",data:"0x",value:"0x0"}],version:"1",capabilities:{paymasterService:{url:"https://api.developer.coinbase.com/rpc/v1/base-sepolia/S-fOd2n2Oi4fl4e1Crm83XeDXZ7tkg8O"}}}]});console.info("response",n),i(n)}catch(e){console.error("error",e)}},[n,t]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:s,children:"Send Calls"}),r&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(r,null,2)})]})}var R=t(3156);function O(e){let{sdk:n,subAccountAddress:t}=e,[r,i]=(0,o.useState)(),s=(0,o.useCallback)(async()=>{if(!n)return;let e=n.getProvider(),{account:a}=await (0,l.eK)();if(!a)return;let r=localStorage.getItem("cbwsdk.demo.spend-permission.signature"),s=JSON.parse(localStorage.getItem("cbwsdk.demo.spend-permission.data"));if(!r||!s)return;let p={account:s.account,spender:s.spender,token:s.token,allowance:s.allowance,period:s.period,start:s.start,end:s.end,salt:s.salt,extraData:s.extraData};try{let n=await (null==e?void 0:e.request({method:"wallet_sendCalls",params:[{version:"1",chainId:(0,h.eC)(S.L.id),from:t,calls:[{to:M,data:(0,R.R)({abi:j,functionName:"approveWithSignature",args:[p,r]}),value:"0x0"},{to:M,data:(0,R.R)({abi:j,functionName:"spend",args:[p,BigInt(1)]}),value:"0x0"}],capabilities:{paymasterService:{url:"https://api.developer.coinbase.com/rpc/v1/base-sepolia/S-fOd2n2Oi4fl4e1Crm83XeDXZ7tkg8O"}}}]}));i(n),console.info("response",n)}catch(e){console.error("error",e)}},[t,n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.z,{w:"full",onClick:s,children:"Use Spend Permission"}),r&&(0,a.jsx)(w.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:JSON.stringify(r,null,2)})]})}function q(){let{sdk:e}=(0,T.I)(),{setSubAccountsConfig:n}=(0,c.Z)(),[t,g]=(0,o.useState)(),[w,S]=(0,o.useState)("cryptokey"),[h,M]=(0,o.useState)(()=>l.eK);return(0,o.useEffect)(()=>{let e=localStorage.getItem("signer-type");null!==e&&S(e)},[]),(0,o.useEffect)(()=>{localStorage.setItem("signer-type",w)},[w]),(0,o.useEffect)(()=>{let e="cryptokey"===w?l.eK:async()=>{let e=(0,b.J)();return{account:(0,m.L)(e)}};M(()=>e),n({toOwnerAccount:e})},[w,n]),(0,a.jsx)(r.W,{mb:16,children:(0,a.jsxs)(i.g,{w:"full",spacing:4,children:[(0,a.jsxs)(s.NI,{children:[(0,a.jsx)(p.l,{children:"Select Signer Type"}),(0,a.jsx)(d.E,{value:w,onChange:e=>S(e),children:(0,a.jsxs)(y.K,{direction:"row",children:[(0,a.jsx)(u.Y,{value:"cryptokey",children:"CryptoKey"}),(0,a.jsx)(u.Y,{value:"secp256k1",children:"secp256k1"})]})})]}),(0,a.jsx)(v,{sdk:e}),(0,a.jsx)(x,{sdk:e,onAddSubAccount:g,signerFn:h}),(0,a.jsx)(C,{sdk:e}),(0,a.jsx)(P,{sdk:e,onAddSubAccount:g,signerFn:h}),(0,a.jsx)(D,{sdk:e,subAccountAddress:t}),(0,a.jsx)(N,{sdk:e,subAccountAddress:t}),(0,a.jsx)(E,{sdk:e,subAccountAddress:t}),(0,a.jsx)(O,{sdk:e,subAccountAddress:t}),(0,a.jsx)(k,{}),(0,a.jsx)(f,{sdk:e})]})})}},7852:function(e,n,t){"use strict";t.d(n,{J:function(){return r}});var a=t(1133);function r(){let e=localStorage.getItem("cbwsdk.demo.add-sub-account.pk");return e||(e=(0,a.w)(),localStorage.setItem("cbwsdk.demo.add-sub-account.pk",e)),e}}},function(e){e.O(0,[712,74,888,774,179],function(){return e(e.s=6348)}),_N_E=e.O()}]);