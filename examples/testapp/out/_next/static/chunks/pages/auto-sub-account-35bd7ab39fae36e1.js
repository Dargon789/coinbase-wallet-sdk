(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{789:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auto-sub-account",function(){return t(3884)}])},3884:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var l=t(2322),i=t(7190),r=t(7993),a=t(8535),s=t(8678),u=t(7166),o=t(5297),c=t(3297),d=t(9669),f=t(5573),h=t(4792),g=t(9117),y=t(2405),p=t(2784),m=t(6797),x=t(5354),b=t(628),v=t(8150);class w extends v.G{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}var j=t(6940),S=t(9310),N=t(8409),E=t(2787),_=t(1844),I=t(7852);function k(){var e;let[n,t]=(0,p.useState)([]),[v,k]=(0,p.useState)(),[C,O]=(0,p.useState)({}),[A,T]=(0,p.useState)("cryptokey"),{subAccountsConfig:J,setSubAccountsConfig:q,config:z,setConfig:$}=(0,E.Z)(),{provider:D}=(0,_.I)();(0,p.useEffect)(()=>{let e=localStorage.getItem("signer-type");null!==e&&T(e)},[]),(0,p.useEffect)(()=>{localStorage.setItem("signer-type",A)},[A]),(0,p.useEffect)(()=>{let e="cryptokey"===A?y.eK:async()=>{let e=(0,I.J)();return{account:(0,S.L)(e)}};q(n=>({...n,toOwnerAccount:e}))},[A,q]);let K=async()=>{if(D)try{let e=await D.request({method:"eth_requestAccounts",params:[]});t(e),k(JSON.stringify(e,null,2))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},Y=async()=>{if(D)try{let e=await D.request({method:"eth_accounts",params:[]});t(e),k(JSON.stringify(e,null,2))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},B=async()=>{if(D&&n.length)try{let e=await D.request({method:"eth_sendTransaction",params:[{from:n[0],to:"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",value:"0x0",data:"0x"}]});k(JSON.stringify(e,null,2))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},R=async()=>{if(D&&n.length)try{let e={types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Person:[{name:"name",type:"string"},{name:"wallet",type:"address"}]},primaryType:"Person",domain:{name:"Test Domain",version:"1",chainId:N.L.id,verifyingContract:"0x0000000000000000000000000000000000000000"},message:{name:"Test User",wallet:n[0]}},t=await D.request({method:"eth_signTypedData_v4",params:[n[0],JSON.stringify(e)]}),l=(0,m.v)({chain:N.L,transport:(0,x.d)()}),i=await l.verifyTypedData({address:n[0],domain:e.domain,types:e.types,primaryType:e.primaryType,message:e.message,signature:t});k("isValid: ".concat(i,"\n").concat(t))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},P=async()=>{var e;if(!D)return;let{account:n}=await J.toOwnerAccount(),l=[{capabilities:{addSubAccount:{account:{type:"create",keys:[{type:n.address?"address":"webauthn-p256",publicKey:null!==(e=n.address)&&void 0!==e?e:n.publicKey}]}}}}];try{let e=await D.request({method:"wallet_connect",params:l});k(JSON.stringify(e,null,2));let n=await D.request({method:"eth_requestAccounts",params:[]});t(n)}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},W=async()=>{if(D)try{let e=await D.request({method:"wallet_connect",params:[]});k(JSON.stringify(e,null,2)),t(e.accounts.map(e=>e.address))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}},L=async e=>{if(D&&n.length)try{O(n=>({...n,[e]:!0}));let t=function(e,n="wei"){return function(e,n){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new w({value:e});let[t,l="0"]=e.split("."),i=t.startsWith("-");if(i&&(t=t.slice(1)),l=l.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${l}`))&&(t=`${BigInt(t)+1n}`),l="";else if(l.length>n){let[e,i,r]=[l.slice(0,n-1),l.slice(n-1,n),l.slice(n)],a=Math.round(Number(`${i}.${r}`));(l=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>n&&(l=l.slice(1),t=`${BigInt(t)+1n}`),l=l.slice(0,n)}else l=l.padEnd(n,"0");return BigInt(`${i?"-":""}${t}${l}`)}(e,b.ez[n])}(e),l=await D.request({method:"eth_sendTransaction",params:[{from:n[0],to:"0x8d25687829d6b85d9e0020b8c89e3ca24de20a89",value:(0,j.eC)(t),data:"0x"}]});k(JSON.stringify(l,null,2))}catch(e){console.error("error",e),k(JSON.stringify(e,null,2))}finally{O(n=>({...n,[e]:!1}))}},F=()=>z.attribution?z.attribution.auto?"auto":"manual":"none";return(0,l.jsx)(i.W,{mb:16,children:(0,l.jsxs)(r.g,{w:"full",spacing:4,children:[(0,l.jsx)(a.xu,{w:"full",textAlign:"left",fontSize:"lg",fontWeight:"bold",children:"Configuration"}),(0,l.jsxs)(s.NI,{children:[(0,l.jsx)(u.l,{children:"Select Signer Type"}),(0,l.jsx)(o.E,{value:A,onChange:e=>T(e),children:(0,l.jsxs)(c.K,{direction:"row",children:[(0,l.jsx)(d.Y,{value:"cryptokey",children:"CryptoKey"}),(0,l.jsx)(d.Y,{value:"secp256k1",children:"secp256k1"})]})})]}),(0,l.jsxs)(s.NI,{children:[(0,l.jsx)(u.l,{children:"Auto Sub-Accounts"}),(0,l.jsx)(o.E,{value:((null==J?void 0:J.enableAutoSubAccounts)||!1).toString(),onChange:e=>q(n=>({...n,enableAutoSubAccounts:"true"===e})),children:(0,l.jsxs)(c.K,{direction:"row",children:[(0,l.jsx)(d.Y,{value:"true",children:"Enabled"}),(0,l.jsx)(d.Y,{value:"false",children:"Disabled"})]})})]}),(0,l.jsxs)(s.NI,{children:[(0,l.jsx)(u.l,{children:"Attribution"}),(0,l.jsx)(o.E,{value:F(),onChange:e=>{if("auto"===e)$({...z,attribution:{auto:!0}});else if("manual"===e)$({...z,attribution:{dataSuffix:"0x"}});else{let{attribution:e,...n}=z;$(n)}},children:(0,l.jsxs)(c.K,{direction:"row",children:[(0,l.jsx)(d.Y,{value:"none",children:"None"}),(0,l.jsx)(d.Y,{value:"auto",children:"Auto"}),(0,l.jsx)(d.Y,{value:"manual",children:"Manual"})]})})]}),"manual"===F()&&(0,l.jsxs)(s.NI,{children:[(0,l.jsx)(u.l,{children:"Attribution Data Suffix (hex)"}),(0,l.jsx)(f.I,{placeholder:"0x...",value:(null===(e=z.attribution)||void 0===e?void 0:e.dataSuffix)||"",onChange:e=>{let n=e.target.value;if(n)$({...z,attribution:{dataSuffix:n}});else{let{attribution:e,...n}=z;$(n)}}})]}),n.length>0&&(0,l.jsxs)(a.xu,{w:"full",children:[(0,l.jsx)(a.xu,{fontSize:"lg",fontWeight:"bold",mb:2,children:"Connected Accounts"}),(0,l.jsx)(r.g,{w:"full",spacing:2,align:"stretch",children:n.map(e=>(0,l.jsx)(a.xu,{p:3,bg:"gray.700",borderRadius:"md",fontFamily:"monospace",fontSize:"sm",children:e},e))})]}),(0,l.jsx)(a.xu,{w:"full",textAlign:"left",fontSize:"lg",fontWeight:"bold",children:"RPCs"}),(0,l.jsx)(h.z,{w:"full",onClick:K,children:"eth_requestAccounts"}),(0,l.jsx)(h.z,{w:"full",onClick:Y,children:"eth_accounts"}),(0,l.jsx)(h.z,{w:"full",onClick:B,isDisabled:!n.length,children:"eth_sendTransaction"}),(0,l.jsx)(h.z,{w:"full",onClick:R,isDisabled:!n.length,children:"eth_signTypedData_v4"}),(0,l.jsx)(h.z,{w:"full",onClick:P,children:"wallet_connect (addSubAccount)"}),(0,l.jsx)(h.z,{w:"full",onClick:W,children:"wallet_connect"}),(0,l.jsx)(a.xu,{w:"full",textAlign:"left",fontSize:"lg",fontWeight:"bold",children:"Send"}),(0,l.jsx)(g.U,{w:"full",spacing:4,children:["0.0001","0.001","0.01"].map(e=>(0,l.jsxs)(h.z,{flex:1,onClick:()=>L(e),isDisabled:!n.length||C[e],isLoading:C[e],loadingText:"Sending...",size:"lg",children:[e," ETH"]},e))}),v&&(0,l.jsx)(a.xu,{as:"pre",w:"full",p:2,bg:"gray.900",borderRadius:"md",border:"1px solid",borderColor:"gray.700",overflow:"auto",whiteSpace:"pre-wrap",children:v})]})})}},7852:function(e,n,t){"use strict";t.d(n,{J:function(){return i}});var l=t(1133);function i(){let e=localStorage.getItem("cbwsdk.demo.add-sub-account.pk");return e||(e=(0,l.w)(),localStorage.setItem("cbwsdk.demo.add-sub-account.pk",e)),e}},6874:function(e,n,t){"use strict";t.d(n,{K:function(){return a},Y:function(){return r}});var l=t(8678),i=t(1053);function r(e){let{isDisabled:n,isInvalid:t,isReadOnly:l,isRequired:r,...s}=a(e);return{...s,disabled:n,readOnly:l,required:r,"aria-invalid":(0,i.Qm)(t),"aria-required":(0,i.Qm)(r),"aria-readonly":(0,i.Qm)(l)}}function a(e){var n,t,r;let a=(0,l.NJ)(),{id:s,disabled:u,readOnly:o,required:c,isRequired:d,isInvalid:f,isReadOnly:h,isDisabled:g,onFocus:y,onBlur:p,...m}=e,x=e["aria-describedby"]?[e["aria-describedby"]]:[];return(null==a?void 0:a.hasFeedbackText)&&(null==a?void 0:a.isInvalid)&&x.push(a.feedbackId),(null==a?void 0:a.hasHelpText)&&x.push(a.helpTextId),{...m,"aria-describedby":x.join(" ")||void 0,id:null!=s?s:null==a?void 0:a.id,isDisabled:null!=(n=null!=u?u:g)?n:null==a?void 0:a.isDisabled,isReadOnly:null!=(t=null!=o?o:h)?t:null==a?void 0:a.isReadOnly,isRequired:null!=(r=null!=c?c:d)?r:null==a?void 0:a.isRequired,isInvalid:null!=f?f:null==a?void 0:a.isInvalid,onFocus:(0,i.v0)(null==a?void 0:a.onFocus,y),onBlur:(0,i.v0)(null==a?void 0:a.onBlur,p)}}},5573:function(e,n,t){"use strict";t.d(n,{I:function(){return c}});var l=t(6874),i=t(9058),r=t(1982),a=t(4586),s=t(4496),u=t(1053),o=t(2322),c=(0,i.G)(function(e,n){let{htmlSize:t,...i}=e,c=(0,r.jC)("Input",i),d=(0,a.Lr)(i),f=(0,l.Y)(d),h=(0,u.cx)("chakra-input",e.className);return(0,o.jsx)(s.m.input,{size:t,...f,__css:c.field,ref:n,className:h})});c.displayName="Input",c.id="Input"},9117:function(e,n,t){"use strict";t.d(n,{U:function(){return a}});var l=t(3297),i=t(9058),r=t(2322),a=(0,i.G)((e,n)=>(0,r.jsx)(l.K,{align:"center",...e,direction:"row",ref:n}));a.displayName="HStack"}},function(e){e.O(0,[712,74,888,774,179],function(){return e(e.s=789)}),_N_E=e.O()}]);